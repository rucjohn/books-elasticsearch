# 数据输入：文档和索引

Elasticsearch 是一个分布式文档存储。Elasticsearch 不按行数据形式存储信息，而是以JSON序列化文档的复杂数据结构进行存储。当集群中有多个 Elasticsearch 节点时，存储的文档分布在集群中，并且可从任一节点访问。

当文档存储时，它接近实时（1秒内）地完成索引和全文检索。Elasticsearch 使用反向索引数据结构，它支持快速全文检索。反向索引会列出文档中出现的每个唯一单词，并标记每个单词出现的所有文档。

索引可以看作是文档的集合，每个文档都是一组字段的集合，字段是包含数据的 key-value。默认情况下，Elasticsearch 对每个字段中的所有数据进行索引，每个索引字段都有一个专用的优化数据结构。例如，文本字段存储在反向索引中，数字和地理字段存储在 BKD 树中。使用每个字段的数据结构来组合和返回搜索结果的能力是 Elasticsearch 如此之快的原因。

Elasticsearch 还具有无模式的能力，这意味着可以为文档编制索引，而无需显式得指定如何处理文档中可能出现的每个不同字段。启用动态映射后，Elasticsearch 会自动检测并向索引中添加新字段。这种默认行为使得索引和搜索数据变得更容易---开始索引文档时，Elasticsearch 将检测并映射布尔型、浮点型和整形的数值、日期和字符串到对应的 Elasticsearch 数据类型中。

最后，你应该要比 Elasticsearch 更了解如何去使用数据。你可以定义规则来控制动态映射，并显式定义映射来掌控字段的存储和索引方式。

自定义映射：
- 区分大小写的字符串字段和精确值的字符串字符
- 执行特定语言的文本分析
- 优化部分匹配字段
- 自定义日期格式
- 使用无法自动检测的数据类型，如`geo_point`和`geo_shape`

为了不同的目的，使用不同的方式去索引相同的字段，这种方法通常有用。例如，您可能希望将字符串字段索引为全文检索的`text`字段和用于排序或聚合的`keyword`字段。又或者，你可以选择多个语言解析器来处理包含用户输入的字符串字段内容。

在索引期间，应用于全文本字段的分析链也可在查询时使用。查询全文本字段时，在精确匹配索引前，查询文本将进行相同的分析。
